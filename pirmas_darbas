<!DOCTYPE html>
<html>
<head>
    <canvas id="FirstTask" width="578" height="250"></canvas>
    <script>
        window.requestAnimFrame = (function(callback) {
          return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame ||
          function(callback) {
            window.setTimeout(callback, 1000 / 60);
          };
        })();
      
        function gear(config){
          this.x = config.x;                          // X position
          this.y = config.y;                          // Y position
          this.radiusO = config.radiusO;              // Outter radius
          this.radiusI = config.radiusI;              // Inner radius
          this.radiusM = config.radiusM;              // Middle radius
          this.radiusH = config.radiusH;              // Hole radius
          this.teethNUM = config.teethNUM;            // number of teeths
          this.theta = config.theta;                  // theta
          this.thetaSpeed = config.thetaSpeed / 1000; // theta Speed
          this.color = config.color;                  // color
          this.spinning = config.spinning;             // boolean to spin or not
          this.clockwise = config.clockwise;          // boolean clockwise spin or not
        }
        
        gear.prototype.draw = function(){
          var canvas = document.getElementById('FirstTask');
          var context = canvas.getContext('2d');		  
		      context.save();
          var numPoints = this.teethNUM * 2;         
          context.beginPath();
          context.LineJoin = 'bevel';         
          for(var n = 0; n < numPoints; n++){            
            var radius = null;
            if(n % 2 == 0){
              radius = this.radiusO;
            }
            else{
              radius = this.radiusI;
            }
            var theta = this.theta;
            theta += ((Math.PI*2) / numPoints) * (n + 1);
            var x = (radius * Math.sin(theta)) + this.x; 
            var y = (radius * Math.cos(theta)) + this.y;
            if(n == 0){
              context.moveTo(x, y);
            }
            else{
              context.lineTo(x, y);
            }
          }
          context.closePath();
          context.fillStyle = this.color;
          context.fill();
          
          context.beginPath();
          context.arc(this.x, this.y, this.radiusM, 0, Math.PI * 2, false);
          context.fillstyle = this.color;
          context.fill();
          context.beginPath();
          context.arc(this.x, this.y, this.radiusH, 0, Math.PI * 2, false);
          context.fillstyle = "white";
          context.fill();
          context.restore;
        } ;
        
        function rotating(gears, lastTime){
          var canvas = document.getElementById('FirstTask');
          var context = canvas.getContext('2d');
          var time = (new Date()).getTime();
          var timeDiff = time - lastTime;
          for(var i = 0; i < gears.length; i++){
            var gear = gears[i];
            if(gears[i].spinning){
              if(gears[i].clockwise){
                gears[i].theta -= (gear.thetaSpeed * timeDiff);
              }
              else{
                gears[i].theta += (gear.thetaSpeed * timeDiff);
              }
            }
          }
          context.clearRect(0, 0, canvas.width, canvas.height);
          for(var i = 0; i < gears.length; i++){
            gears[i].draw();
          }
          requestAnimFrame(function(){
            rotating(gears,time);
          });
        }
        var gears = [];
        gears.push(new gear({
          x: 120,
          y: 105,
          radiusO: 90,
          radiusI: 50,
          radiusM: 80,
          radiusH: 10,
          teethNUM: 24,
          theta: 0,
          thetaSpeed: 1,
          color: '#FF0000',
          spinning: true,
          clockwise: false
        }));
      // red gear
        gears.push(new gear({
          x: 222,
          y: 190,
          radiusO: 90,
          radiusI: 50,
          radiusM: 80,
          radiusH: 10,
          teethNUM: 24,
          theta: 0,
          thetaSpeed: 1,
          color: '#00FF00',
          spinning: false,
          clockwise: false
        }));
      var time = (new Date()).getTime();
      rotating(gears, time);
	</script>
    <style>
      body,html{
        margin:0px;
        padding:0px;
      }
    </style>
</head>
<body>

</body>
</html>
